---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

#### Setup
```{r}
source("R/utils.R")
source("R/plot_utils.R")

agg_names = c(
  here("data", "processed", "BTY-1_agg.rds"),
  here("data", "processed", "FY6-1_agg.rds"),
  here("data", "processed", "JFH-1_agg.rds")
)

names = c(
  here("data", "processed", "BTY-1.rds"),
  here("data", "processed", "FY6-1.rds"),
  here("data", "processed", "JFH-1.rds")
)

raw_names = c(
  here("data", "raw", "ST003061", "BTY-1.mzML"),
  here("data", "raw", "ST003061", "FY6-1.mzML"),
  here("data", "raw", "ST003061", "JFH-1.mzML")
)

model = stan_model(file = here("models", "peak_model.stan"))
```

#### Data
```{r}
readRDS(agg_names[1])
readRDS(agg_names[2])
readRDS(agg_names[3])
```

#### Correlations
```{r}
data1 = readRDS(agg_names[1])
data2 = readRDS(agg_names[2])
data3 = readRDS(agg_names[3])

df = rbind(data1, data2, data3)

print(paste("R2 vs Position:", cor(df$mz_r2, df$mz_position)))
print(paste("Evidence vs Position:", cor(df$avg_evidence, df$mz_position)))
```

#### Plots
```{r}
plotGraph()
```

```{r}
for (i in 1:3) {
  
  plotMSAgg(agg_names[i])
  plotEvidence(names[i])
  plotPrec(names[i])
  plotAmp(names[i])
}
```

```{r}
plotPPC(names[2], raw_names[2])
```

```{r}
plotPairs(names[2], raw_names[2], model)
```

